C *********************************************************************
C  hknsff07.f  Version 1.2                                2009/DEC/19
C
C  [Package for the HKNS fragmentaion functions]
C  Reference:
C    Determination of fragmentation functions and their uncertainties
C    M. Hirai, S. Kumano, T.-H. Nagai, and K. Sudoh
C    Phys. Rev. D75 (2007) 094009. (hep-ph/0702250) 
C *********************************************************************
C ---------------------------------------------------------------------
C  SUBROUTINE HKNSFF(Q2,X,ISET,ICHARGE,FF,GRAD):
C
C   Subroutine HKNSFF returns the values of fragmentaion functions
C   and their gradient terms at specified Q^2 and x point 
C   by interpolating the grid data.
C   [ Log(Q^2): LINEAR INTERPOLATION, x: CUBIC SPLINE INTERPOLATION ]
C
C   INPUT:
C     Q2, X ... Q^2 and x values at which the functions are calculated. 
C               Available range: 10^-2 <= X <= 1.0,
C                           1.0 GeV^2 <= Q^2 <= 10^8 GeV^2.
C     ISET=1: Pion LO Fragmentation functions and their gradient terms 
C          2: Pion NLO
C          3: Kaon LO
C          4: Kaon NLO
C          5: Proton LO
C          6: Proton NLO
C
C     ICHARGE=1: pi^+, K^+, or proton
C     ICHARGE=2: pi^-, K^-, or neutron
C     ICHARGE=3: pi^0=[pi^+ + pi^-]/2, [K^0+K^0b]/2, or [p+pb]/2
C        If you want to obtain the fragmentaion functions for each
C        K0, K0b, pb, or nb, you may use the relations in Appendix of
C        hep-ph/0702250.
C
C   OUTPUT: Arrays FF(-5:5) & GRAD(I,J)
C
C     FF(I) --> HKNS fragmentation functions (FFs).
C      I = -5 ... b-bar quark (D_b-bar = D_b)
C          -4 ... c-bar quark (D_c-bar = D_c)
C          -3 ... s-bar quark
C          -2 ... d-bar quark 
C          -1 ... u-bar quark 
C           0 ... gluon D_g(x)
C           1 ... u quark 
C           2 ... d quark 
C           3 ... s quark 
C           4 ... c quark 
C           5 ... b quark 
C
C     GRAD(I,J) --> Gradient terms of HKSN FFs
C      I is the same index as the one in FF(I).
C      J indicates the parameter index for a gradient term dFF(I)/da_J
C      (a_J = parameter).
C
C Pion,J= 1..2: g (2ndM, alpha)           2ndM = second moment
C         3..5: u (2ndM, alpha, beta)
C         6..8: d (2ndM, alpha, beta)
C        9..11: c (2ndM, alpha, beta)
C       12..14: b (2ndM, alpha, beta)
C   For example, the above J=14 indicates d D_b^{pi^+}/d beta_b^{pi^+}.
C
C Kaon,J= 1..2: g (2ndM, beta)
C         3..5: u (2ndM, alpha, beta)
C         6..8: d (2ndM, alpha, beta)
C        9..11: sb(2ndM, alpha, beta)
C       12..14: c (2ndM, alpha, beta)
C       15..17: b (2ndM, alpha, beta)
C
CProton,J=1..2: g (2ndM, beta)
C         3..5: u (2nsM, alpha, beta)
C         6..8: qb(2ndM, alpha, beta)
C        9..11: c (2ndM, alpha, beta)
C       11..13: b (2ndM, alpha, beta)
C
C   NOTE: The returned values are not multiplied by x.
C
C      *  Error matrix can be used by declaring a common block:
C         COMMON/ERRM/EM(17,17). This matrix is defined as
C         the inverse matrix of Hessian multiplied by Delta chi^2:
C         EM(i,j)=Delta chi^2*H_ij^-1.
C         The values of Delta chi^2 are as follows:
C         15.9359730(pion), 19.1977555(kaon), 14.8470228(proton).
C *********************************************************************
      SUBROUTINE HKNSFF(Q2,X,ISET,ICHARGE,FF,GRAD)
C ---------------------------------------------------------------------
      IMPLICIT REAL*8(A-H,O-Z)
      PARAMETER (NQ=33, NX=53, ND=146, NFF=8, NSET=3, IFILE=20)
      DIMENSION IREAD(2), QG(NQ), XG(NX),PDFJ1(ND), PDFJ2(ND)
     +         ,FF(-5:5), GRADFF(8,17), GRAD(-5:5,17)
     +         ,BXG(NX,NQ,ND), CXG(NX,NQ,ND), DXG(NX,NQ,ND)
     +         ,PDFG(NX,NQ,ND), EMI(17,17,6)

      COMMON/ERRM/EM(17,17)
      SAVE IREAD, NPAR, BXG, CXG, DXG, PDFG 
      DATA IREAD /1, 1/ 
      DATA CTHRE,BTHRE/2.0449D0,18.490D0/
      DATA EPS/1.D-12/

C      INCLUDE 'EM.inc'
      DATA ((EMI(I,J,1),J=1,17),I=1,17)/
     + 1.975025E-01, 4.287287E-01,
     +-6.547055E-02, 1.934978E-01, 1.326334E-01,
     +-1.084258E-01, 4.855261E-01, 7.816977E-01,
     +-8.059443E-02, 1.861848E-01, 1.083935E-01,
     +-3.925652E-02, 4.821763E-02,-4.947434E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 4.287287E-01, 1.281107E+01,
     + 7.942887E-02,-6.184703E-02, 8.171154E-02,
     +-3.678644E-01, 3.494807E-01,-1.063310E+00,
     +-1.838438E-01,-3.514025E-02,-1.142673E+00,
     +-8.085307E-02,-8.104128E-02,-8.030248E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-6.547055E-02, 7.942887E-02,
     + 1.158866E-01,-2.156472E-01,-9.975967E-02,
     +-4.862958E-04,-4.616859E-02,-7.264095E-02,
     + 2.665164E-02,-7.587977E-02,-7.432442E-02,
     + 1.258606E-02,-1.646074E-02, 1.763618E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.934978E-01,-6.184703E-02,
     +-2.156472E-01, 5.318727E-01, 3.522981E-01,
     +-5.231716E-02, 2.844651E-01, 7.107061E-01,
     +-7.941995E-02, 2.129237E-01, 2.076601E-01,
     +-3.745177E-02, 4.787788E-02,-5.549320E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.326334E-01, 8.171154E-02,
     +-9.975967E-02, 3.522981E-01, 3.108041E-01,
     +-5.783308E-02, 2.348771E-01, 6.827130E-01,
     +-5.457306E-02, 1.374833E-01, 1.253740E-01,
     +-2.575540E-02, 3.168135E-02,-4.299271E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-1.084258E-01,-3.678644E-01,
     +-4.862958E-04,-5.231716E-02,-5.783308E-02,
     + 7.415773E-02,-3.071324E-01,-5.036516E-01,
     + 4.426248E-02,-9.474271E-02,-3.895166E-02,
     + 2.163245E-02,-2.521581E-02, 3.120694E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 4.855261E-01, 3.494807E-01,
     +-4.616859E-02, 2.844651E-01, 2.348771E-01,
     +-3.071324E-01, 1.447171E+00, 2.491844E+00,
     +-1.960619E-01, 4.635041E-01, 2.872124E-01,
     +-9.668195E-02, 1.294027E-01,-8.070774E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 7.816977E-01,-1.063310E+00,
     +-7.264095E-02, 7.107061E-01, 6.827130E-01,
     +-5.036516E-01, 2.491844E+00, 5.282058E+00,
     +-3.143610E-01, 7.969963E-01, 6.436922E-01,
     +-1.534255E-01, 2.175675E-01,-1.267452E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-8.059443E-02,-1.838438E-01,
     + 2.665164E-02,-7.941995E-02,-5.457306E-02,
     + 4.426248E-02,-1.960619E-01,-3.143610E-01,
     + 3.362602E-02,-8.110693E-02,-6.209053E-02,
     + 1.591371E-02,-1.903393E-02, 2.299019E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.861848E-01,-3.514025E-02,
     +-7.587977E-02, 2.129237E-01, 1.374833E-01,
     +-9.474271E-02, 4.635041E-01, 7.969963E-01,
     +-8.110693E-02, 2.404659E-01, 3.235512E-01,
     +-3.630597E-02, 4.758131E-02,-4.247080E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.083935E-01,-1.142673E+00,
     +-7.432442E-02, 2.076601E-01, 1.253740E-01,
     +-3.895166E-02, 2.872124E-01, 6.436922E-01,
     +-6.209053E-02, 3.235512E-01, 8.896432E-01,
     +-1.887154E-02, 2.993620E-02,-3.797208E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-3.925652E-02,-8.085307E-02,
     + 1.258606E-02,-3.745177E-02,-2.575540E-02,
     + 2.163245E-02,-9.668195E-02,-1.534255E-01,
     + 1.591371E-02,-3.630597E-02,-1.887154E-02,
     + 8.388330E-03,-1.276132E-02,-6.198647E-03,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 4.821763E-02,-8.104128E-02,
     +-1.646074E-02, 4.787788E-02, 3.168135E-02,
     +-2.521581E-02, 1.294027E-01, 2.175675E-01,
     +-1.903393E-02, 4.758131E-02, 2.993620E-02,
     +-1.276132E-02, 3.213043E-02, 8.896799E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-4.947434E-02,-8.030248E-01,
     + 1.763618E-02,-5.549320E-02,-4.299271E-02,
     + 3.120694E-02,-8.070774E-02,-1.267452E-01,
     + 2.299019E-02,-4.247080E-02,-3.797208E-02,
     +-6.198647E-03, 8.896799E-02, 5.651454E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00/

      DATA ((EMI(I,J,2),J=1,17),I=1,17)/
     + 1.310200E-02, 1.120420E-01,
     +-1.304358E-02, 5.653016E-02, 3.724508E-02,
     +-9.776592E-03, 1.704225E-01, 2.133954E-01,
     +-7.805742E-03, 1.545525E-02,-3.137554E-02,
     +-3.161235E-03,-3.799917E-03,-3.850370E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.120420E-01, 2.543286E+00,
     + 5.373467E-02,-5.642131E-02, 6.385433E-02,
     +-1.614808E-01, 1.894915E+00, 9.586970E-01,
     +-6.727323E-02,-2.449885E-01,-1.293284E+00,
     +-1.863616E-02,-1.393696E-01,-6.490770E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-1.304358E-02, 5.373467E-02,
     + 4.319732E-02,-1.137083E-01,-4.029953E-02,
     +-3.841271E-03,-1.733467E-02,-4.598293E-02,
     + 7.442896E-03,-5.285293E-02,-6.411185E-02,
     + 3.759535E-03,-5.624219E-03, 1.292399E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 5.653016E-02,-5.642131E-02,
     +-1.137083E-01, 5.018907E-01, 3.432800E-01,
     +-1.791379E-02, 4.919833E-01, 1.196790E+00,
     +-3.333104E-02, 1.888014E-01, 2.053525E-01,
     +-1.561933E-02, 1.434414E-02,-8.534622E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 3.724508E-02, 6.385433E-02,
     +-4.029953E-02, 3.432800E-01, 3.301424E-01,
     +-2.869543E-02, 4.846145E-01, 1.153025E+00,
     +-2.224407E-02, 9.634108E-02, 7.061038E-02,
     +-9.841180E-03, 3.267831E-03,-7.549348E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-9.776592E-03,-1.614808E-01,
     +-3.841271E-03,-1.791379E-02,-2.869543E-02,
     + 1.353396E-02,-1.911058E-01,-2.267577E-01,
     + 5.939353E-03, 6.544681E-03, 6.960817E-02,
     + 2.017749E-03, 7.581332E-03, 4.229535E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.704225E-01, 1.894915E+00,
     +-1.733467E-02, 4.919833E-01, 4.846145E-01,
     +-1.911058E-01, 3.456513E+00, 5.053090E+00,
     +-1.021090E-01, 8.326450E-02,-6.956737E-01,
     +-4.088215E-02,-6.420317E-02,-5.138395E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 2.133954E-01, 9.586970E-01,
     +-4.598293E-02, 1.196790E+00, 1.153025E+00,
     +-2.267577E-01, 5.053090E+00, 1.039870E+01,
     +-1.274683E-01, 4.021602E-01,-2.236295E-02,
     +-5.714943E-02, 5.296416E-03,-4.144022E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-7.805742E-03,-6.727323E-02,
     + 7.442896E-03,-3.333104E-02,-2.224407E-02,
     + 5.939353E-03,-1.021090E-01,-1.274683E-01,
     + 4.902256E-03,-1.268629E-02, 7.390881E-03,
     + 1.836175E-03, 2.532848E-03, 2.409424E-02,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.545525E-02,-2.449885E-01,
     +-5.285293E-02, 1.888014E-01, 9.634108E-02,
     + 6.544681E-03, 8.326450E-02, 4.021602E-01,
     +-1.268629E-02, 1.843234E-01, 4.555425E-01,
     +-4.852042E-03, 1.540067E-02, 6.584457E-03,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-3.137554E-02,-1.293284E+00,
     +-6.411185E-02, 2.053525E-01, 7.061038E-02,
     + 6.960817E-02,-6.956737E-01,-2.236295E-02,
     + 7.390881E-03, 4.555425E-01, 1.660178E+00,
     + 5.217581E-03, 5.771276E-02, 1.971901E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-3.161235E-03,-1.863616E-02,
     + 3.759535E-03,-1.561933E-02,-9.841180E-03,
     + 2.017749E-03,-4.088215E-02,-5.714943E-02,
     + 1.836175E-03,-4.852042E-03, 5.217581E-03,
     + 1.259202E-03,-2.511318E-03,-7.206916E-03,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-3.799917E-03,-1.393696E-01,
     +-5.624219E-03, 1.434414E-02, 3.267831E-03,
     + 7.581332E-03,-6.420317E-02, 5.296416E-03,
     + 2.532848E-03, 1.540067E-02, 5.771276E-02,
     +-2.511318E-03, 2.745513E-02, 1.335435E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-3.850370E-02,-6.490770E-01,
     + 1.292399E-02,-8.534622E-02,-7.549348E-02,
     + 4.229535E-02,-5.138395E-01,-4.144022E-01,
     + 2.409424E-02, 6.584457E-03, 1.971901E-01,
     +-7.206916E-03, 1.335435E-01, 7.652120E-01,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00/

      DATA ((EMI(I,J,3),J=1,17),I=1,17)/
     + 4.174149E-03, 2.724008E-02,
     + 2.305266E-03,-1.082358E-01,-2.800722E-02,
     +-4.274092E-03, 9.702718E-02, 3.947346E-01,
     + 3.343711E-03,-1.034208E-01,-1.302942E-02,
     +-1.468214E-03, 3.096579E-02, 6.253035E-02,
     +-7.346252E-04, 2.301081E-02, 1.132950E-01,
     + 2.724008E-02, 5.040006E-01,
     + 2.046327E-02,-9.628135E-01,-3.576772E-01,
     +-3.134187E-02, 6.700324E-01, 2.931344E+00,
     + 3.638685E-02,-1.043081E+00,-2.757105E-01,
     +-8.780420E-03, 1.817805E-01, 3.352062E-01,
     +-4.230782E-03, 1.252012E-01, 5.856909E-01,
     + 2.305266E-03, 2.046327E-02,
     + 3.371683E-02,-1.008581E+00,-2.444393E-01,
     +-2.636965E-02, 2.378506E-01, 2.327382E+00,
     + 6.675175E-02,-1.903141E+00,-6.679417E-01,
     +-9.802969E-04, 1.395629E-02, 2.254066E-02,
     +-4.049959E-04, 1.315845E-02, 6.357414E-02,
     +-1.082358E-01,-9.628135E-01,
     +-1.008581E+00, 4.947876E+01, 2.067310E+01,
     + 7.214113E-01,-7.040969E+00,-5.873592E+01,
     +-1.644940E+00, 3.909546E+01, 1.112602E+01,
     + 4.157639E-02,-3.075135E-01, 2.699665E-01,
     + 1.904074E-02,-6.267856E-01,-3.036624E+00,
     +-2.800722E-02,-3.576772E-01,
     +-2.444393E-01, 2.067310E+01, 1.265391E+01,
     + 1.221952E-01,-1.401682E+00,-7.953668E+00,
     +-1.988427E-01,-3.227930E-01,-2.871427E+00,
     + 1.036894E-02, 6.013831E-03, 4.447410E-01,
     + 4.826277E-03,-1.612759E-01,-7.702735E-01,
     +-4.274092E-03,-3.134187E-02,
     +-2.636965E-02, 7.214113E-01, 1.221952E-01,
     + 2.533489E-02,-2.626790E-01,-2.306898E+00,
     +-6.339905E-02, 1.842424E+00, 6.492777E-01,
     + 1.545145E-03,-3.107982E-02,-5.879735E-02,
     + 7.503078E-04,-2.401044E-02,-1.177009E-01,
     + 9.702718E-02, 6.700324E-01,
     + 2.378506E-01,-7.040969E+00,-1.401682E+00,
     +-2.626790E-01, 4.060594E+00, 2.606326E+01,
     + 5.455023E-01,-1.495870E+01,-4.474018E+00,
     +-3.433711E-02, 7.201078E-01, 1.415266E+00,
     +-1.695235E-02, 5.141447E-01, 2.530533E+00,
     + 3.947346E-01, 2.931344E+00,
     + 2.327382E+00,-5.873592E+01,-7.953668E+00,
     +-2.306898E+00, 2.606326E+01, 2.197087E+02,
     + 5.810162E+00,-1.662604E+02,-5.706590E+01,
     +-1.415738E-01, 3.033207E+00, 5.903444E+00,
     +-6.884622E-02, 2.122446E+00, 1.040301E+01,
     + 3.343711E-03, 3.638685E-02,
     + 6.675175E-02,-1.644940E+00,-1.988427E-01,
     +-6.339905E-02, 5.455023E-01, 5.810162E+00,
     + 1.775460E-01,-5.174006E+00,-1.891624E+00,
     +-1.213179E-03, 2.500738E-02, 4.048845E-02,
     +-5.774474E-04, 1.951913E-02, 9.479948E-02,
     +-1.034208E-01,-1.043081E+00,
     +-1.903141E+00, 3.909546E+01,-3.227930E-01,
     + 1.842424E+00,-1.495870E+01,-1.662604E+02,
     +-5.174006E+00, 1.581947E+02, 6.062882E+01,
     + 3.773300E-02,-8.327526E-01,-1.596065E+00,
     + 1.793905E-02,-6.044183E-01,-2.948084E+00,
     +-1.302942E-02,-2.757105E-01,
     +-6.679417E-01, 1.112602E+01,-2.871427E+00,
     + 6.492777E-01,-4.474018E+00,-5.706590E+01,
     +-1.891624E+00, 6.062882E+01, 2.508609E+01,
     + 4.886194E-03,-1.047357E-01,-1.923941E-01,
     + 2.093477E-03,-7.973922E-02,-3.783686E-01,
     +-1.468214E-03,-8.780420E-03,
     +-9.802969E-04, 4.157639E-02, 1.036894E-02,
     + 1.545145E-03,-3.433711E-02,-1.415738E-01,
     +-1.213179E-03, 3.773300E-02, 4.886194E-03,
     + 5.703231E-04,-1.193830E-02,-2.508456E-02,
     + 2.577567E-04,-8.095598E-03,-3.985838E-02,
     + 3.096579E-02, 1.817805E-01,
     + 1.395629E-02,-3.075135E-01, 6.013831E-03,
     +-3.107982E-02, 7.201078E-01, 3.033207E+00,
     + 2.500738E-02,-8.327526E-01,-1.047357E-01,
     +-1.193830E-02, 4.708729E-01, 1.115372E+00,
     +-5.460629E-03, 1.637954E-01, 8.182083E-01,
     + 6.253035E-02, 3.352062E-01,
     + 2.254066E-02, 2.699665E-01, 4.447410E-01,
     +-5.879735E-02, 1.415266E+00, 5.903444E+00,
     + 4.048845E-02,-1.596065E+00,-1.923941E-01,
     +-2.508456E-02, 1.115372E+00, 2.897287E+00,
     +-1.103810E-02, 3.197540E-01, 1.597622E+00,
     +-7.346252E-04,-4.230782E-03,
     +-4.049959E-04, 1.904074E-02, 4.826277E-03,
     + 7.503078E-04,-1.695235E-02,-6.884622E-02,
     +-5.774474E-04, 1.793905E-02, 2.093477E-03,
     + 2.577567E-04,-5.460629E-03,-1.103810E-02,
     + 1.407128E-04,-4.599072E-03,-2.275011E-02,
     + 2.301081E-02, 1.252012E-01,
     + 1.315845E-02,-6.267856E-01,-1.612759E-01,
     +-2.401044E-02, 5.141447E-01, 2.122446E+00,
     + 1.951913E-02,-6.044183E-01,-7.973922E-02,
     +-8.095598E-03, 1.637954E-01, 3.197540E-01,
     +-4.599072E-03, 2.307877E-01, 1.108438E+00,
     + 1.132950E-01, 5.856909E-01,
     + 6.357414E-02,-3.036624E+00,-7.702735E-01,
     +-1.177009E-01, 2.530533E+00, 1.040301E+01,
     + 9.479948E-02,-2.948084E+00,-3.783686E-01,
     +-3.985838E-02, 8.182083E-01, 1.597622E+00,
     +-2.275011E-02, 1.108438E+00, 5.483570E+00/

      DATA ((EMI(I,J,4),J=1,17),I=1,17)/
     + 1.899052E-03, 2.109968E-02,
     +-9.778646E-04, 8.397617E-03, 8.377171E-03,
     +-1.016381E-03, 1.229672E-01, 2.493270E-01,
     +-3.072850E-03, 8.435859E-02, 2.599146E-02,
     +-9.576148E-04, 3.136702E-02, 7.547002E-02,
     +-4.338789E-04, 1.758180E-02, 1.040052E-01,
     + 2.109968E-02, 1.096758E+00,
     +-1.622251E-02, 6.433936E-04,-6.355129E-01,
     +-8.545132E-03, 1.875164E+00, 3.419389E+00,
     +-3.653717E-02, 1.658223E+00, 8.477268E-02,
     +-1.067057E-02, 3.118637E-01, 4.487610E-01,
     +-4.741846E-03, 1.453151E-01, 7.184491E-01,
     +-9.778646E-04,-1.622251E-02,
     + 1.382140E-02,-1.156375E-01, 4.649082E-02,
     +-5.977336E-03, 1.773930E-01, 1.188228E+00,
     + 1.653553E-02,-8.805626E-01,-3.223284E-01,
     + 3.778752E-04,-1.389772E-02,-3.058932E-02,
     + 2.200946E-04,-8.382815E-03,-4.950928E-02,
     + 8.397617E-03, 6.433936E-04,
     +-1.156375E-01, 7.590351E+00, 6.998023E+00,
     +-6.941716E-03,-4.477473E+00,-5.757157E+00,
     + 4.747893E-02,-8.244860E+00,-5.229584E+00,
     +-4.303292E-03, 2.850464E-01, 1.106979E+00,
     +-1.811667E-03, 5.778736E-02, 3.719028E-01,
     + 8.377171E-03,-6.355129E-01,
     + 4.649082E-02, 6.998023E+00, 1.143247E+01,
     +-9.532262E-02,-2.001308E+00, 9.026401E+00,
     + 2.610396E-01,-2.099639E+01,-1.148734E+01,
     +-5.367040E-03, 1.884811E-01, 9.149305E-01,
     +-1.902244E-03, 1.045155E-01, 7.376949E-01,
     +-1.016381E-03,-8.545132E-03,
     +-5.977336E-03,-6.941716E-03,-9.532262E-02,
     + 5.752108E-03,-1.796964E-01,-1.115115E+00,
     +-1.307743E-02, 8.019267E-01, 3.192395E-01,
     + 5.257344E-04,-1.930718E-02,-4.859489E-02,
     + 2.325789E-04,-9.729307E-03,-5.774243E-02,
     + 1.229672E-01, 1.875164E+00,
     + 1.773930E-01,-4.477473E+00,-2.001308E+00,
     +-1.796964E-01, 1.692213E+01, 5.254771E+01,
     + 7.166772E-02,-3.464369E+00, 8.047699E-02,
     +-6.277992E-02, 1.908697E+00, 4.100794E+00,
     +-2.799206E-02, 1.066741E+00, 6.261137E+00,
     + 2.493270E-01, 3.419389E+00,
     + 1.188228E+00,-5.757157E+00, 9.026401E+00,
     +-1.115115E+00, 5.254771E+01, 2.649117E+02,
     + 2.337000E+00,-1.265295E+02,-4.343972E+01,
     +-1.275860E-01, 4.413775E+00, 9.966150E+00,
     +-5.651262E-02, 2.082189E+00, 1.229902E+01,
     +-3.072850E-03,-3.653717E-02,
     + 1.653553E-02, 4.747893E-02, 2.610396E-01,
     +-1.307743E-02, 7.166772E-02, 2.337000E+00,
     + 4.911477E-02,-2.669851E+00,-1.052356E+00,
     + 1.567612E-03,-4.322202E-02,-9.998729E-02,
     + 6.992034E-04,-2.774191E-02,-1.638751E-01,
     + 8.435859E-02, 1.658223E+00,
     +-8.805626E-01,-8.244860E+00,-2.099639E+01,
     + 8.019267E-01,-3.464369E+00,-1.265295E+02,
     +-2.669851E+00, 1.629260E+02, 6.935362E+01,
     +-4.274169E-02, 1.016043E+00, 1.815286E+00,
     +-1.900655E-02, 6.830062E-01, 3.941702E+00,
     + 2.599146E-02, 8.477268E-02,
     +-3.223284E-01,-5.229584E+00,-1.148734E+01,
     + 3.192395E-01, 8.047699E-02,-4.343972E+01,
     +-1.052356E+00, 6.935362E+01, 3.310423E+01,
     +-1.307085E-02, 3.829031E-01, 8.713554E-01,
     +-5.858886E-03, 2.228495E-01, 1.362161E+00,
     +-9.576148E-04,-1.067057E-02,
     + 3.778752E-04,-4.303292E-03,-5.367040E-03,
     + 5.257344E-04,-6.277992E-02,-1.275860E-01,
     + 1.567612E-03,-4.274169E-02,-1.307085E-02,
     + 5.214859E-04,-1.692657E-02,-4.157543E-02,
     + 2.173301E-04,-8.810157E-03,-5.202016E-02,
     + 3.136702E-02, 3.118637E-01,
     +-1.389772E-02, 2.850464E-01, 1.884811E-01,
     +-1.930718E-02, 1.908697E+00, 4.413775E+00,
     +-4.322202E-02, 1.016043E+00, 3.829031E-01,
     +-1.692657E-02, 9.950638E-01, 2.662997E+00,
     +-7.156712E-03, 2.812087E-01, 1.693411E+00,
     + 7.547002E-02, 4.487610E-01,
     +-3.058932E-02, 1.106979E+00, 9.149305E-01,
     +-4.859489E-02, 4.100794E+00, 9.966150E+00,
     +-9.998729E-02, 1.815286E+00, 8.713554E-01,
     +-4.157543E-02, 2.662997E+00, 7.759445E+00,
     +-1.721614E-02, 6.735302E-01, 4.106208E+00,
     +-4.338789E-04,-4.741846E-03,
     + 2.200946E-04,-1.811667E-03,-1.902244E-03,
     + 2.325789E-04,-2.799206E-02,-5.651262E-02,
     + 6.992034E-04,-1.900655E-02,-5.858886E-03,
     + 2.173301E-04,-7.156712E-03,-1.721614E-02,
     + 1.066385E-04,-4.471868E-03,-2.646987E-02,
     + 1.758180E-02, 1.453151E-01,
     +-8.382815E-03, 5.778736E-02, 1.045155E-01,
     +-9.729307E-03, 1.066741E+00, 2.082189E+00,
     +-2.774191E-02, 6.830062E-01, 2.228495E-01,
     +-8.810157E-03, 2.812087E-01, 6.735302E-01,
     +-4.471868E-03, 3.065152E-01, 1.719608E+00,
     + 1.040052E-01, 7.184491E-01,
     +-4.950928E-02, 3.719028E-01, 7.376949E-01,
     +-5.774243E-02, 6.261137E+00, 1.229902E+01,
     +-1.638751E-01, 3.941702E+00, 1.362161E+00,
     +-5.202016E-02, 1.693411E+00, 4.106208E+00,
     +-2.646987E-02, 1.719608E+00, 9.987863E+00/

      DATA ((EMI(I,J,5),J=1,17),I=1,17)/
     + 1.850874E+01,-3.934045E-02,
     + 6.249246E-01,-1.850117E+00, 2.163686E-02,
     +-4.030878E+00,-1.153416E+01, 6.644028E-03,
     +-9.538232E-01,-7.253691E+00, 3.427034E-03,
     +-5.371504E-01,-5.387480E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-3.934045E-02, 2.336105E-03,
     + 2.099874E-02, 4.323884E-02,-1.071799E-03,
     + 9.492073E-02, 1.893337E-01,-1.732855E-04,
     + 1.290805E-02, 4.800339E-02,-6.085320E-05,
     + 7.659475E-03, 3.634536E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 6.249246E-01, 2.099874E-02,
     + 5.948252E-01, 7.590065E-01,-1.043529E-02,
     +-1.790640E-02, 4.623214E-01,-1.384604E-03,
     + 1.643254E-02,-6.921593E-02,-3.358025E-04,
     + 1.340468E-02,-7.125235E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-1.850117E+00, 4.323884E-02,
     + 7.590065E-01, 1.558225E+00,-2.130429E-02,
     + 8.959985E-01, 2.363809E+00,-3.481345E-03,
     + 2.384090E-01, 1.199942E+00,-1.177114E-03,
     + 1.405724E-01, 8.652028E-01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 2.163686E-02,-1.071799E-03,
     +-1.043529E-02,-2.130429E-02, 4.980463E-04,
     +-4.172028E-02,-8.591824E-02, 7.754600E-05,
     +-5.805750E-03,-2.227024E-02, 2.756706E-05,
     +-3.474441E-03,-1.705938E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-4.030878E+00, 9.492073E-02,
     +-1.790640E-02, 8.959985E-01,-4.172028E-02,
     + 6.813106E+00, 1.305522E+01,-7.669616E-03,
     + 4.890060E-01, 2.399323E+00,-3.012060E-03,
     + 3.950050E-01, 2.285907E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-1.153416E+01, 1.893337E-01,
     + 4.623214E-01, 2.363809E+00,-8.591824E-02,
     + 1.305522E+01, 2.910922E+01,-1.587414E-02,
     + 7.101524E-01, 4.547480E+00,-6.299948E-03,
     + 7.258249E-01, 4.845756E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 6.644028E-03,-1.732855E-04,
     +-1.384604E-03,-3.481345E-03, 7.754600E-05,
     +-7.669616E-03,-1.587414E-02, 3.375352E-05,
     +-1.288756E-03,-7.413267E-03, 4.438725E-06,
     +-7.114515E-04,-3.777127E-03, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-9.538232E-01, 1.290805E-02,
     + 1.643254E-02, 2.384090E-01,-5.805750E-03,
     + 4.890060E-01, 7.101524E-01,-1.288756E-03,
     + 1.916751E+00, 6.258852E+00,-4.575036E-04,
     +-2.392137E-02, 6.898773E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-7.253691E+00, 4.800339E-02,
     +-6.921593E-02, 1.199942E+00,-2.227024E-02,
     + 2.399323E+00, 4.547480E+00,-7.413267E-03,
     + 6.258852E+00, 2.320278E+01,-2.123703E-03,
     + 2.052081E-02, 1.237162E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 3.427034E-03,-6.085320E-05,
     +-3.358025E-04,-1.177114E-03, 2.756706E-05,
     +-3.012060E-03,-6.299948E-03, 4.438725E-06,
     +-4.575036E-04,-2.123703E-03, 5.044395E-06,
     +-4.617068E-04,-3.060120E-03, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-5.371504E-01, 7.659475E-03,
     + 1.340468E-02, 1.405724E-01,-3.474441E-03,
     + 3.950050E-01, 7.258249E-01,-7.114515E-04,
     +-2.392137E-02, 2.052081E-02,-4.617068E-04,
     + 4.683256E-01, 2.074664E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-5.387480E+00, 3.634536E-02,
     +-7.125235E-02, 8.652028E-01,-1.705938E-02,
     + 2.285907E+00, 4.845756E+00,-3.777127E-03,
     + 6.898773E-02, 1.237162E+00,-3.060120E-03,
     + 2.074664E+00, 1.044270E+01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00/

      DATA ((EMI(I,J,6),J=1,17),I=1,17)/
     + 6.216359E+01,-2.637871E-01,
     + 3.503986E+00, 2.454792E+00, 1.240334E-01,
     + 2.311310E-01,-2.297606E+01, 3.520838E-02,
     +-1.592299E+00,-2.794863E+01, 1.494694E-02,
     +-8.121425E-01,-1.750835E+01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-2.637871E-01, 1.886685E-03,
     + 1.007618E-03, 5.977144E-03,-9.399101E-04,
     + 1.298363E-01, 2.433427E-01,-2.103823E-04,
     + 1.252836E-02, 1.367705E-01,-8.154193E-05,
     + 5.034522E-03, 7.979384E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 3.503986E+00, 1.007618E-03,
     + 7.129629E-01, 7.748067E-01,-2.143435E-03,
     + 1.913351E+00, 6.258243E-01, 7.215891E-04,
     +-5.878011E-02,-1.449255E+00, 5.414694E-04,
     +-4.001555E-02,-9.821543E-01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 2.454792E+00, 5.977144E-03,
     + 7.748067E-01, 1.068367E+00,-4.859549E-03,
     + 1.604919E+00,-2.047820E-02, 1.035175E-04,
     +-2.659028E-02,-9.658523E-01, 3.167672E-04,
     +-2.786801E-02,-6.972221E-01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.240334E-01,-9.399101E-04,
     +-2.143435E-03,-4.859549E-03, 4.739585E-04,
     +-6.780234E-02,-1.211645E-01, 1.011436E-04,
     +-5.902939E-03,-6.420907E-02, 3.889979E-05,
     +-2.373267E-03,-3.742444E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 2.311310E-01, 1.298363E-01,
     + 1.913351E+00, 1.604919E+00,-6.780234E-02,
     + 3.000554E+01, 3.478539E+01,-1.034325E-02,
     + 1.346258E+00, 4.581331E+00,-3.342139E-03,
     + 4.302281E-01, 1.681574E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-2.297606E+01, 2.433427E-01,
     + 6.258243E-01,-2.047820E-02,-1.211645E-01,
     + 3.478539E+01, 5.260790E+01,-2.485540E-02,
     + 1.644144E+00, 1.400116E+01,-9.412463E-03,
     + 7.323814E-01, 8.212705E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 3.520838E-02,-2.103823E-04,
     + 7.215891E-04, 1.035175E-04, 1.011436E-04,
     +-1.034325E-02,-2.485540E-02, 4.088781E-05,
     +-1.681455E-03,-1.998305E-02, 9.567911E-06,
     +-6.334364E-04,-1.040323E-02, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-1.592299E+00, 1.252836E-02,
     +-5.878011E-02,-2.659028E-02,-5.902939E-03,
     + 1.346258E+00, 1.644144E+00,-1.681455E-03,
     + 2.064835E+00, 7.273794E+00,-5.262290E-04,
     +-5.131547E-02, 1.453494E-01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-2.794863E+01, 1.367705E-01,
     +-1.449255E+00,-9.658523E-01,-6.420907E-02,
     + 4.581331E+00, 1.400116E+01,-1.998305E-02,
     + 7.273794E+00, 3.591896E+01,-7.113045E-03,
     + 1.042778E-01, 6.658236E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 1.494694E-02,-8.154193E-05,
     + 5.414694E-04, 3.167672E-04, 3.889979E-05,
     +-3.342139E-03,-9.412463E-03, 9.567911E-06,
     +-5.262290E-04,-7.113045E-03, 6.678176E-06,
     +-5.327854E-04,-6.181335E-03, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-8.121425E-01, 5.034522E-03,
     +-4.001555E-02,-2.786801E-02,-2.373267E-03,
     + 4.302281E-01, 7.323814E-01,-6.334364E-04,
     +-5.131547E-02, 1.042778E-01,-5.327854E-04,
     + 4.019312E-01, 1.965627E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     +-1.750835E+01, 7.979384E-02,
     +-9.821543E-01,-6.972221E-01,-3.742444E-02,
     + 1.681574E+00, 8.212705E+00,-1.040323E-02,
     + 1.453494E-01, 6.658236E+00,-6.181335E-03,
     + 1.965627E+00, 1.340536E+01, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00,
     + 0.000000E+00, 0.000000E+00, 0.000000E+00/

C Q2 AND X GRID.
      DATA QG /
     +  1.000000D+00, 1.467799D+00, 2.154435D+00,
     +  3.162278D+00, 4.641589D+00, 6.812921D+00,
     +  1.000000D+01, 1.467799D+01, 2.154435D+01,
     +  3.162278D+01, 4.641589D+01, 6.812921D+01,
     +  1.000000D+02, 1.778279D+02, 3.162278D+02, 5.623413D+02,
     +  1.000000D+03, 1.778279D+03, 3.162278D+03, 5.623413D+03,
     +  1.000000D+04, 1.778279D+04, 3.162278D+04, 5.623413D+04,
     +  1.000000D+05, 1.778279D+05, 3.162278D+05, 5.623413D+05,
     +  1.000000D+06, 4.641589D+06, 
     +  1.000000D+07, 4.641589D+07,  
     +  1.000000D+08  /

      DATA XG / 
     +  1.000000D-02, 1.154782D-02, 1.333521D-02, 1.539927D-02,
     +  1.778279D-02, 2.053525D-02, 2.371374D-02, 2.738420D-02,
     +  3.162278D-02, 3.651741D-02, 4.216965D-02, 4.869675D-02,
     +  5.623413D-02, 6.493816D-02, 7.498942D-02, 8.659643D-02,
     +  1.000000D-1, 1.250000D-1, 1.500000D-1, 1.750000D-1,
     +  2.000000D-1, 2.250000D-1, 2.500000D-1, 2.750000D-1,
     +  3.000000D-1, 3.250000D-1, 3.500000D-1, 3.750000D-1,
     +  4.000000D-1, 4.250000D-1, 4.500000D-1, 4.750000D-1, 
     +  5.000000D-1, 5.250000D-1, 5.500000D-1, 5.750000D-1,
     +  6.000000D-1, 6.250000D-1, 6.500000D-1, 6.750000D-1,
     +  7.000000D-1, 7.250000D-1, 7.500000D-1, 7.750000D-1,
     +  8.000000D-1, 8.250000D-1, 8.500000D-1, 8.750000D-1,
     +  9.000000D-1, 9.250000D-1, 9.500000D-1, 9.750000D-1,
     +  1.000000D+0 /

C CALCULATE SPLINE COEFFICIENTS.
      IF((IREAD(1).NE.1).AND.(IREAD(2).EQ.ISET)) GO TO 20
      CTHRE=CTHRE-EPS
      BTHRE=BTHRE-EPS

C READ GRID DATA AND CALCULATE SPLINE COEFFICIENTS. 
      IF(ISET.EQ.1) THEN
        OPEN(UNIT=IFILE,FILE='hkns_pilo.grd',STATUS='OLD')
        OPEN(UNIT=IFILE+1,FILE='gradpilo.grd',STATUS='OLD')
        NPAR=14

      ELSE IF(ISET.EQ.2) THEN
        OPEN(UNIT=IFILE,FILE='hkns_pinlo.grd',STATUS='OLD')
        OPEN(UNIT=IFILE+1,FILE='gradpinlo.grd',STATUS='OLD')
        NPAR=14

      ELSE IF(ISET.EQ.3) THEN
        OPEN(UNIT=IFILE,FILE='hkns_klo.grd',STATUS='OLD')
        OPEN(UNIT=IFILE+1,FILE='gradklo.grd',STATUS='OLD')
        NPAR=17

      ELSE IF(ISET.EQ.4) THEN
        OPEN(UNIT=IFILE,FILE='hkns_knlo.grd',STATUS='OLD')
        OPEN(UNIT=IFILE+1,FILE='gradknlo.grd',STATUS='OLD')
        NPAR=17

      ELSE IF(ISET.EQ.5) THEN
        OPEN(UNIT=IFILE,FILE='hkns_plo.grd',STATUS='OLD')
        OPEN(UNIT=IFILE+1,FILE='gradplo.grd',STATUS='OLD')
        NPAR=13

      ELSE IF(ISET.EQ.6) THEN
        OPEN(UNIT=IFILE,FILE='hkns_pnlo.grd',STATUS='OLD')
        OPEN(UNIT=IFILE+1,FILE='gradpnlo.grd',STATUS='OLD')
        NPAR=13

      ELSE
        WRITE(*,1010) ISET
 1010   FORMAT(' ','HKNSFF ERROR: ISET =', I3)
        STOP
      END IF

      DO I=1,17
        DO J=1,17
          EM(I,J)=EMI(I,J,ISET)
        ENDDO
      ENDDO

      DO J=1,NQ
        DO K=1,NX-1
          READ(IFILE,1025) (PDFG(K,J,I), I=1,8)

          DO NR=1,NPAR
            NI=10+NFF*(NR-1)
            READ(IFILE+1,1025) (PDFG(K,J,I),I=NI,NI+NFF-1)
          ENDDO
        ENDDO
      ENDDO

 1025 FORMAT(1X,8(1PE14.6))
      CLOSE(IFILE)
      CLOSE(IFILE+1)

      DO I=1,ND
        DO J=1,NQ
          PDFG(NX,J,I)=0.D0 ! x=1 FF=0.D0
          CALL LSPHNKS(NX,XG,PDFG,BXG,CXG,DXG,ISET,I,J)
        ENDDO
      ENDDO

      IREAD(1)=2
      IREAD(2)=ISET
   20 CONTINUE

      DO I=1,11
        FF(I-6)=0.D0
      END DO
      DO J=1,17
        DO I=1,8
          GRADFF(I,J)=0.D0
        ENDDO
      ENDDO

C CHECK X AND Q2 VALUES.
      IF(ICHARGE.GT.3) THEN
        WRITE(*,1026) ICHARGE
 1026   FORMAT(' ','HKNSFF ERROR: ICHARGE =', I3)
        STOP
      ENDIF

      IF((X.LT.1.D-2).OR.(X.GT.1.D0)) THEN
        WRITE(*,1030) X
 1030   FORMAT (' ','FF WARNING: OUT OF RANGE --> X =', 1PE12.3)
        STOP
      ENDIF
      IF((Q2.LT.1.D0).OR.(Q2.GT.1.D8)) THEN
        WRITE(*,1040) Q2
 1040   FORMAT (' ','FF WARNING: OUT OF RANGE --> Q2 =', 1PE12.3)
        STOP
      ENDIF

C INTERPOLATION.
C X: CUBIC SPLINE INTERPOLATION, LOG(Q2): LINEAR INTERPOLATION.
      J=ISRHKNS(NQ,QG,Q2)
      IF(J.EQ.NQ) J=NQ-1
      K=ISRHKNS(NX,XG,X)
      DO I=1,ND
        DX=X-XG(K)
        PDFJ1(I)=PDFG(K,J,I)
     >       +DX*(BXG(K,J,I)+DX*(CXG(K,J,I)+DX*DXG(K,J,I)))
        PDFJ2(I)=PDFG(K,J+1,I)
     >       +DX*(BXG(K,J+1,I)+DX*(CXG(K,J+1,I)+DX*DXG(K,J+1,I)))
      ENDDO

C -- Fragmentation functions --
      T=(DLOG(Q2)-DLOG(QG(J)))/(DLOG(QG(J+1))-DLOG(QG(J)))
      DO I=1,3
        FF(I-1)=(1.D0-T)*PDFJ1(I)+T*PDFJ2(I)     ! g, u, d
        FF(-I)=(1.D0-T)*PDFJ1(I+3)+T*PDFJ2(I+3)  ! ub, [db, s]^pi+, [sb, s]^K; 
        FF(I+2)=(1.D0-T)*PDFJ1(I+5)+T*PDFJ2(I+5) ! s, c, b
      ENDDO
      IF(Q2.LT.CTHRE) FF(4)=0.D0
      IF(Q2.LT.BTHRE) FF(5)=0.D0
      FF(-4)=FF(4) ! cb=c
      FF(-5)=FF(5) ! bb=b

      IF((ISET.EQ.3).or.(ISET.EQ.4)) THEN  ! K+ 
        FF(-3)=FF(-2) ! FF(-2)=sb -> FF(-3)
        FF(-2)=FF(2)  ! db=d
      ENDIF

      IF(ICHARGE.EQ.2) THEN ! Negative charge
        IF(ISET.LT.3) THEN  ! pi:u<->ub, d<->db
          TEMP1=FF(-1);TEMP2=FF(2)
          FF(-1)=FF(1);FF(2)=FF(-2)
          FF(1)=TEMP1;FF(-2)=TEMP2

        ELSE IF((ISET.EQ.3).OR.(ISET.EQ.4)) THEN ! K:u<->ub, s<->sb
          TEMP1=FF(-1);TEMP2=FF(3)
          FF(-1)=FF(1);FF(3)=FF(-3)
          FF(1)=TEMP1;FF(-3)=TEMP2

        ELSE IF(ISET.GT.4) THEN ! neutron, u<->d, ub<->db
          TEMP1=FF(-1);TEMP2=FF(1)
          FF(-1)=FF(-2);FF(1)=FF(2)
          FF(-2)=TEMP1;FF(2)=TEMP2
        ENDIF

      ELSE IF(ICHARGE.EQ.3) THEN ! (pi^+ + pi^-)/2, (K^0 + K^0b)/2, (p+pb)/2
        IF((ISET.EQ.3).OR.(ISET.EQ.4)) THEN ! K^0: u<->d, ub<->db
          TEMP1=FF(-1);TEMP2=FF(1)
          FF(-1)=FF(-2);FF(1)=FF(2)
          FF(-2)=TEMP1;FF(2)=TEMP2
        ENDIF
        DO I=1,5 ! (pi^+ + pi^-)/2, (K^0 + K^0b)/2, (p+pb)/2
          FF(I)=(FF(I)+FF(-I))/2.D0
          FF(-I)=FF(I)
        ENDDO
      ENDIF

C -- Gradient terms of parameters for fragmentation functions --
      DO J=1,NPAR
        DO I=1,NFF
          NI=9+NFF*(J-1)
          GRADFF(I,J)=(1.D0-T)*PDFJ1(NI+I)+T*PDFJ2(NI+I)
        ENDDO
      ENDDO

      IF(Q2.LT.CTHRE) THEN
        DO J=1,NPAR
          GRADFF(NFF-1,J)=0.D0
          IF(J.GT.NPAR-6) THEN
            DO I=1,NFF-2
              GRADFF(I,J)=0.D0
            ENDDO
          ENDIF
        ENDDO
      ENDIF 

      IF(Q2.LT.BTHRE) THEN
        DO J=1,NPAR
          GRADFF(NFF,J)=0.D0
          IF(J.GT.NPAR-3) THEN
            DO I=1,NFF-1
              GRADFF(I,J)=0.D0
            ENDDO
          ENDIF
        ENDDO
      ENDIF

      DO J=1,NPAR
        DO I=1,3
          GRAD(I-1,J)=GRADFF(I,J)   ! g, u, d
          GRAD(-I,J)=GRADFF(I+3,J)  ! ub, [db, s]^pi+, [sb, s]^K+
          GRAD(I+2,J)=GRADFF(I+5,J) ! s, c, b
        ENDDO
        GRAD(-4,J)=GRAD(4,J) ! cb=c      
        GRAD(-5,J)=GRAD(5,J) ! bb=b     

        IF((ISET.EQ.3).OR.(ISET.EQ.4)) THEN ! K+
          GRAD(-3,J)=GRAD(-2,J)
          GRAD(-2,J)=GRAD(2,J)
        ENDIF
      ENDDO

      DO J=1,NPAR
        IF(ICHARGE.EQ.2) THEN
          IF(ISET.LT.3) THEN
            TEMP1=GRAD(-1,J);TEMP2=GRAD(2,J)
            GRAD(-1,J)=GRAD(1,J);GRAD(2,J)=GRAD(-2,J)
            GRAD(1,J)=TEMP1;GRAD(-2,J)=TEMP2

          ELSE IF((ISET.EQ.3).OR.(ISET.EQ.4)) THEN
            TEMP1=GRAD(-1,J);TEMP2=GRAD(3,J)
            GRAD(-1,J)=GRAD(1,J);GRAD(3,J)=GRAD(-3,J)
            GRAD(1,J)=TEMP1;GRAD(-3,J)=TEMP2

          ELSE IF(ISET.GT.4) THEN
            TEMP1=GRAD(-1,J);TEMP2=GRAD(1,J)
            GRAD(-1,J)=GRAD(-2,J);GRAD(1,J)=GRAD(2,J)
            GRAD(-2,J)=TEMP1;GRAD(2,J)=TEMP2
          ENDIF

        ELSE IF(ICHARGE.EQ.3) THEN
          IF((ISET.EQ.3).OR.(ISET.EQ.4)) THEN
            TEMP1=GRAD(-1,J);TEMP2=GRAD(1,J)
            GRAD(-1,J)=GRAD(-2,J);GRAD(1,J)=GRAD(2,J)
            GRAD(-2,J)=TEMP1;GRAD(2,J)=TEMP2
          ENDIF
          DO I=1,5
            GRAD(I,J)=(GRAD(I,J)+GRAD(-I,J))*0.5D0
            GRAD(-I,J)=GRAD(I,J)
          ENDDO
        ENDIF
      ENDDO

      RETURN
      END
C ---------------------------------------------------------------------
      SUBROUTINE LSPHNKS(N,X,Y,B,C,D,ISET,I,J)
C ---------------------------------------------------------------------
C CALCULATE THE COEFFICIENTS B,C,D IN A CUBIC SPLINE INTERPOLATION.
C INTERPOLATION SUBROUTINES ARE TAKEN FROM
C G.E. FORSYTHE, M.A. MALCOLM AND C.B. MOLER,
C COMPUTER METHODS FOR MATHEMATICAL COMPUTATIONS (PRENTICE-HALL, 1977).
      IMPLICIT REAL*8(A-H,O-Z)
      PARAMETER (NQ=33, NX=53, ND=146)
      DIMENSION Y(NX,NQ,ND),B(NX,NQ,ND),C(NX,NQ,ND),D(NX,NQ,ND)
     1         ,X(NX) 
      NM1=N-1
      IF(N.LT.2) RETURN
      IF(N.LT.3) GO TO 250
      D(1,J,I)=X(2)-X(1)
      C(2,J,I)=(Y(2,J,I)-Y(1,J,I))/D(1,J,I)
      DO 210 K=2,NM1
        D(K,J,I)=X(K+1)-X(K)
        B(K,J,I)=2.0D0*(D(K-1,J,I)+D(K,J,I))
        C(K+1,J,I)=(Y(K+1,J,I)-Y(K,J,I))/D(K,J,I)
        C(K,J,I)=C(K+1,J,I)-C(K,J,I)
  210 CONTINUE
      B(1,J,I)=-D(1,J,I)
      B(N,J,I)=-D(N-1,J,I)
      C(1,J,I)=0.0D0
      C(N,J,I)=0.0D0
      IF(N.EQ.3) GO TO 215
      C(1,J,I)=C(3,J,I)/(X(4)-X(2))-C(2,J,I)/(X(3)-X(1))
      C(N,J,I)=C(N-1,J,I)/(X(N)-X(N-2))-C(N-2,J,I)/(X(N-1)-X(N-3))
      C(1,J,I)=C(1,J,I)*D(1,J,I)**2.0D0/(X(4)-X(1))
      C(N,J,I)=-C(N,J,I)*D(N-1,J,I)**2.0D0/(X(N)-X(N-3))
  215 CONTINUE
      DO 220 K=2,N
        T=D(K-1,J,I)/B(K-1,J,I)
        B(K,J,I)=B(K,J,I)-T*D(K-1,J,I)
        C(K,J,I)=C(K,J,I)-T*C(K-1,J,I)
  220 CONTINUE
      C(N,J,I)=C(N,J,I)/B(N,J,I)
      DO 230 IB=1,NM1
        K=N-IB
        C(K,J,I)=(C(K,J,I)-D(K,J,I)*C(K+1,J,I))/B(K,J,I)
  230 CONTINUE
      B(N,J,I)=(Y(N,J,I)-Y(NM1,J,I))/D(NM1,J,I)
     1        +D(NM1,J,I)*(C(NM1,J,I)+2.0D0*C(N,J,I))
      DO 240 K=1,NM1
        B(K,J,I)=(Y(K+1,J,I)-Y(K,J,I))/D(K,J,I)
     1          -D(K,J,I)*(C(K+1,J,I)+2.0D0*C(K,J,I))
        D(K,J,I)=(C(K+1,J,I)-C(K,J,I))/D(K,J,I)
        C(K,J,I)=3.0D0*C(K,J,I)
  240 CONTINUE
      C(N,J,I)=3.0D0*C(N,J,I)
      D(N,J,I)=D(N-1,J,I)
      RETURN
  250 CONTINUE
      B(1,J,I)=(Y(2,J,I)-Y(1,J,I))/(X(2)-X(1))
      C(1,J,I)=0.0D0
      D(1,J,I)=0.0D0
      B(2,J,I)=B(1,J,I)
      C(2,J,I)=0.0D0
      D(2,J,I)=0.0D0
      RETURN
      END
C ---------------------------------------------------------------------
      INTEGER FUNCTION ISRHKNS(N,X,Y)
C ---------------------------------------------------------------------
C THIS FUNCTION SEARCHES "I" WHICH SATISFIES THE RELATION
C X(I) <= Y < X(I+1) BY USING A BINARY SEARCH.
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION X(53)

      MIN=1
      MAX=N+1

   10 CONTINUE
      MID=(MIN+MAX)/2
      IF(Y.LT.X(MID)) THEN
        MAX=MID
      ELSE
        MIN=MID
      END IF
      IF((MAX-MIN).GT.1) GO TO 10

      ISRHKNS=MIN

      RETURN
      END
C *********************************************************************
C THE END OF THE PROGRAM.
C *********************************************************************
